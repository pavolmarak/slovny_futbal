{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Slovný futbal</title>
    <!-- Option 1: Use Bulma from CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

    <!-- Option 2: Use your own static file -->
    {# <link rel="stylesheet" href="{% static 'css/bulma.min.css' %}"> #}

    <link rel="stylesheet" href="{% static 'word_soccer_app/main.css' %}">
</head>
<body>

<!-- Navbar -->
<nav class="navbar is-primary">
    <div class="navbar-brand">
        <a class="navbar-item" href="/">
            <strong>Slovný futbal</strong>
        </a>
    </div>
    <div class="navbar-menu">
        <div class="navbar-start">
            <a class="navbar-item" href="#">Home</a>
            <a class="navbar-item" href="#">About</a>
        </div>
    </div>
</nav>

<!-- Hero Section -->
<section class="hero is-link is-bold">
    <div class="hero-body">
        <p class="title">Welcome to Django + Bulma</p>
        <p class="subtitle">This is a styled template using Bulma framework.</p>
    </div>
</section>


<!-- Game area -->
<section class="section gamearea">
    <div class="container">

        {#        time panel #}
        <div class="columns is-centered">
            <div id="time_panel" class="column is-three-fifths has-text-centered time_panel is-size-5">1:30</div>
        </div>
        
        {#        stadium with player panels #}
        <div class="columns is-centered">
            <div id="player1_panel" class="column is-one-fifth player1_panel">Player 1<br></div>
            <div class="column is-three-fifths stadium">
                <div class="columns" style="color: white;">Player 1</div>
                <div class="columns player1_points">
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                </div>

                <div class="columns" style="color: white;">Player 2</div>
                <div class="columns player2_points">
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                    <div class="column is-1-21"></div>
                </div>
            </div>
            <div id="player2_panel" class="column is-one-fifth player2_panel">Player 2<br></div>
        </div>

        {#        word #}
        <div class="columns is-centered">
            <div id="word" class="column is-three-fifths word is-centered has-text-centered"></div>
        </div>

        {#        deleters #}
        <div class="columns is-centered">
            <div class="column is-three-fifths delete_box is-flex is-justify-content-center">
                <div class="columns">
                    <div class="column remover">
                        <div id="remover" class="">Del slovo</div>
                    </div>
                    <div class="column deleter">
                        <div id="deleter" class="">Del písmeno</div>
                    </div>
                </div>
            </div>
        </div>

        {#        letters #}
        <div class="columns is-centered">
            <div class="column is-three-fifths is-flex is-justify-content-center letters">
                <div class="columns">
                    <div class="column letter">
                        <div id="l1" class="let">R</div>
                    </div>
                    <div class="column letter">
                        <div id="l2" class="let">A</div>
                    </div>
                    <div class="column letter">
                        <div id="l3" class="let">B</div>
                    </div>
                    <div class="column letter">
                        <div id="l4" class="let">S</div>
                    </div>
                    <div class="column letter">
                        <div id="l5" class="let">A</div>
                    </div>
                    <div class="column letter">
                        <div id="l6" class="let">L</div>
                    </div>
                    <div class="column letter">
                        <div id="l7" class="let">Q</div>
                    </div>
                    <div class="column letter">
                        <div id="l8" class="let">Z</div>
                    </div>
                    <div class="column letter">
                        <div id="l9" class="let">Č</div>
                    </div>
                    <div class="column letter">
                        <div id="l10" class="let">Ľ</div>
                    </div>
                    <div class="column letter">
                        <div id="l11" class="let">P</div>
                    </div>
                </div>
            </div>
        </div>

        {#        submit word #}
        <div class="columns is-centered">
            <div class="column is-three-fifths controls">
                <div class="columns is-centered">
                    <div id="submit_word" class="column is-one-fifth has-text-centered submit">
                        <form id="myForm" method="post" action="find/">
                            {% csrf_token %}
                            <button type="submit">Potvrdiť</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div id="response" class="has-text-centered"></div>

        <script>
            document.getElementById('myForm').addEventListener('submit', function (e) {
                e.preventDefault(); // Prevent default form submission
                
                // cannot submit word once timer elapsed
                const t = JSON.parse(localStorage.getItem("time_in_seconds"));
                if(t <= 0){
                    alert('po limite');
                    return;
                }

                const word = document.getElementById('word');
                const formData = new FormData(this);
                
                // cannot submit short words
                if (word.textContent.length < 2) {
                    alert('kratke slovo');
                    return;
                }
                formData.append('word', word.textContent);

                fetch("find/", {
                    method: "POST",
                    body: formData,
                    headers: {
                        "X-Requested-With": "XMLHttpRequest"
                    },
                })
                    .then(response => response.json())
                    .then(data => {
                        const p1_panel = document.getElementById('player1_panel');
                        p1_panel.innerHTML += word.textContent;
                        if (data.result === 'present') {
                            p1_panel.innerHTML += " ...OK";
                            word.textContent = "";
                            document.querySelectorAll('.let').forEach(one_letter => {
                                one_letter.style.backgroundColor = "#359ec4";
                            });
                            if (localStorage.getItem("order_in_word") !== null) {
                                let new_order_in_word = new Array(11).fill(-1)
                                localStorage.setItem("order_in_word", JSON.stringify(new_order_in_word));
                            }
                        }
                        p1_panel.innerHTML += "<br>";
                        document.getElementById('response').innerText = data.result;
                    })
                    .catch(error => console.error("Error:", error));
            });
        </script>


    </div>
</section>


<!-- Footer -->
<footer class="footer">
    <div class="content has-text-centered">
        <p>&copy; 2025 Slovný Futbal by Pavol Marák. Made with Bulma and Django ❤️</p>
    </div>
</footer>


<script src="{% static 'word_soccer_app/scripts.js' %}"></script>
</body>
</html>
